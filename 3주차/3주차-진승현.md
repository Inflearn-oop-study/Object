## 4장. 설계 품질과 트레이드오프

객체지향 설계란 올바른 객체에게 올바른 책임을 할당하는 것 이다. 이를 위해 객체의 상태가 아닌 책임에 포커스를 맞추어 객체를 설계할 필요가 있다.

### 데이터 중심의 영화 예매 시스템

상태를 객체 분할의 중심축으로 삼게 되면 객체가 어떻게 되었는지, 즉 내부 상태가 어떻게 관리되는지가 노출되기 때문에 캡슐화의 원칙이 무너지게 된다.

데이터 중심의 설계는 객체가 내부에 저장해야 하는 데이터가 무엇인지를 먼저 묻는다.

### 설계 트레이드오프

변경될 가능성이 높은 부분을 구현이라고 부르고, 상대적으로 안정적인 부분을 인터페이스라고 부른다. 

객체를 설계하기 위한 기본이 되는 아이디어는 구현과 인터페이스를 분리하고, 외부에서는 인터페이스에만 의존하도록 관계를 조절하는 것이다.

즉 객체지향에서 가장 중요한 원리는 캡슐화이며, 변경 가능성이 높은 부분을 객체 내부로 숨김으로써 변경되는 요구사항에 대해 유연성을 가질 수 있다.

응집도는 얼마나 관련있는 책임들을 할당했는지를 나타내며, 결합도는 어떤 모듈이 다른 모듈에 대한 지식을 어느정도 알고있는지에 따라 평가될 수 있다.

그렇기에 좋은 설계란 높은 응집도와 낮은 결합도를 추구해야 한다. 

하나의 변경에 대해 하나의 모듈만 변경된다면 응집도가 높다고 볼 수 있고, 응집도가 높기 때문에 변경의 대상과 범위가 명확해져 코드를 변경하기가 쉬워진다. 

한 모듈이 변경되기 위해 다른 여러 모듈을 변경해야 한다면 결합도가 높다고 볼 수 있고, 결합도가 높을 수록 변경해야하는 모듈의 수가 많아지니 코드를 변경하기가 어려워진다.

### 데이터 중심의 영화 예매 시스템의 문제점

데이터 중심으로 객체를 설계한 경우 getter, setter 메소드를 활용하여 내부 데이터에 접근할 수 있기 때문에 캡슐화의 원칙을 지키고 있는 것 처럼 보이지만, getter, setter 메소드의 경우 변수가 존재한다는 사실을 인터페이스에 노골적으로 드러낸다.

즉 데이터 중심 설계는 getter, setter 를 통해 내부 구현을 인터페이스의 일부로 만들기 때문에 캡슐화를 위반한다.

### 자율적인 객체를 향해

A 라는 객체의 값을 B 라는 객체에서 조절하는 것이 아닌, A 라는 객체의 값은 A 내부에서 조절할 수 있어야 한다. 즉 자신의 값들을 스스로 수정할 수 있도록 책임을 이동시킨 것 이며, 객체가 자기 스스로를 책임진다는 뜻이라고 볼 수 있다.

### 하지만 여전히 부족하다

파라미터를 통해 입력받는 값들을 보고, 해당 파라미터가 내부 인스턴스 변수로 포함되어 있다는 사실을 알 수 있다. 이 때문에 내부 정보를 인터페이스를 통해 외부로 노출하고 있음을 알 수 있다.

또한 메소드명에 따라 내부 정보를 노출하게 될 수도 있다.

이를 통해 단지 내부 속성을 접근 제어자를 통해 외부로부터 감추는 건 캡슐화의 일부일 뿐이며, 내부 구현의 변경으로 인해 외부 객체가 영향을 받는다면 이는 캡슐화를 위반한 것 이다.

### 데이터 중심 설계의 문제점

데이터를 중심으로 설계하다 보면, 결국 getter, setter 메소드를 통해 데이터를 외부로 노출하게 된다.

데이터를 먼저 결정하고 메소드를 설계하는 방식은 결국 객체의 인터페이스에 데이터와 관련된 지식이 고스란히 드러나게 된다.

결국 객체들과 어떻게 협력할 것 인지, 어울리는 책임을 결정하는 것이 가장 중요하다.

## 5장. 책임 할당하기

책임에 초점을 맞춰서 객체를 설계해야한다는 사실을 알겠지만, 어떤 객체에게 어떤 책임을 할당하도록 해야할지 결정하는건 어렵다.

다양한 책임 할당 방법이 존재하며, 올바른 책임을 할당하기 위해서는 다양한 관점에서 설계를 평가할 수 있어야 한다.

### 책임 주도 설계를 향해

어떤 메시지를 보낼 것 인지를 먼저 결정한 후, 이를 해결할 수 있는 객체를 선택할 필요가 있다.

### 책임 할당을 위한 GRASP 패턴

1. 메시지 정의하기
2. 메시지를 수신할 객체 정의하기

도메인 설계는 구현과 밀접한 관계를 맺어야 한다.

## 느낀점

책을 읽을수록 다형성이란 개념이 얼마나 중요한지 느낄 수 있었습니다. GRASP 패턴 챕터에서도 다른 중요한 부분들이 많이 나왔지만, 저는 역시 책임과 다형성이 메인이 아닐까 라는 생각이 들었습니다.